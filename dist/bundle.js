(()=>{"use strict";class s{constructor(s,t,i,e,h){this.x=s,this.y=t,this.width=i,this.height=e,this.color=h}render(s){s.beginPath(),s.rect(this.x,this.y,this.width,this.height),s.fillStyle=this.color,s.fill(),s.closePath()}}class t extends s{constructor(s,t,i,e,h,d=1){super(s,t,i,e,h),this.status=d}render(s){1===this.status&&super.render(s)}}class i{constructor(){this.sounds={brickHit:new Audio("assets/sounds/brick-hit.mp3"),paddleHit:new Audio("assets/sounds/paddle-hit.mp3"),gameOver:new Audio("assets/sounds/game-over.mp3"),ballMiss:new Audio("assets/sounds/ball-miss.mp3"),win:new Audio("assets/sounds/win.mp3"),backgroundMusic:new Audio("assets/sounds/background-music.mp3")},this.sounds.backgroundMusic.loop=!0,this.sounds.backgroundMusic.volume=.3}play(s){this.sounds[s]&&this.sounds[s].play()}startBackgroundMusic(){this.sounds.backgroundMusic.play()}stopBackgroundMusic(){this.sounds.backgroundMusic.pause()}}const e=document.getElementById("myCanvas"),h=e.getContext("2d"),d=new class extends s{constructor(s,t,i,e,h,d="#FFD700",a=5){super(s,t,2*i,2*i,d),this.radius=i,this.dx=e,this.dy=h,this.baseSpeed=Math.sqrt(e**2+h**2),this.maxSpeed=a}move(){this.x+=this.dx,this.y+=this.dy}increaseSpeed(s){const t=1+.001*s,i=Math.min(this.maxSpeed,this.baseSpeed*t),e=Math.atan2(this.dy,this.dx);this.dx=i*Math.cos(e),this.dy=i*Math.sin(e)}bounceOffPaddle(s){const t=s.y,i=s.y+s.height,e=s.x,h=s.x+s.width;if(this.y+this.radius>=t&&this.y+this.radius<=i&&this.x>=e&&this.x<=h){const t=(this.x-(s.x+s.width/2))/(s.width/2);if(Math.abs(t)<.2)this.dy=-Math.abs(this.dy);else{const s=t*(Math.PI/3),i=Math.sqrt(this.dx**2+this.dy**2);this.dx=i*Math.cos(s),this.dy=-Math.abs(i*Math.sin(s))}return!0}return!1}render(s){s.beginPath(),s.arc(this.x,this.y,this.radius,0,2*Math.PI),s.fillStyle=this.color,s.fill(),s.closePath()}}(e.width/2,e.height-30,10,2,-2,"#FFD700",5),a=new class extends s{constructor(s,t,i,e,h,d="#40E0D0"){super(s,t,i,e,d),this.canvas=h,this.speed=7,this.rightPressed=!1,this.leftPressed=!1,this.canvas.addEventListener("mousemove",(s=>this.handleMouseMove(s)))}handleKeyDown(s){"Right"===s.key||"ArrowRight"===s.key?this.rightPressed=!0:"Left"!==s.key&&"ArrowLeft"!==s.key||(this.leftPressed=!0)}handleKeyUp(s){"Right"===s.key||"ArrowRight"===s.key?this.rightPressed=!1:"Left"!==s.key&&"ArrowLeft"!==s.key||(this.leftPressed=!1)}handleMouseMove(s){const t=s.clientX-this.canvas.offsetLeft;t>0&&t<this.canvas.width&&(this.x=t-this.width/2)}move(){this.rightPressed?this.x=Math.min(this.x+this.speed,this.canvas.width-this.width):this.leftPressed&&(this.x=Math.max(this.x-this.speed,0))}}((e.width-75)/2,e.height-10,75,10,e),o=new class{constructor(s,t){this.color1=s,this.color2=t}render(s,t){const i=s.createRadialGradient(t.width/2,t.height/2,50,t.width/2,t.height/2,t.width);i.addColorStop(0,this.color1),i.addColorStop(1,this.color2),s.fillStyle=i,s.fillRect(0,0,t.width,t.height)}}("#8A2BE2","#000000"),r=new class{constructor(s,t,i="#0095DD",e="16px Arial"){this.x=s,this.y=t,this.color=i,this.font=e,this.score=0}update(s){this.score+=s}reset(){this.score=0}render(s){s.font=this.font,s.fillStyle=this.color,s.fillText(`Score: ${this.score}`,this.x,this.y)}}(8,20),n=new class{constructor(s,t,i="#0095DD",e="16px Arial",h=3){this.x=s,this.y=t,this.color=i,this.font=e,this.lives=h}loseLife(){this.lives-=1}reset(){this.lives=3}render(s){s.font=this.font,s.fillStyle=this.color,s.fillText(`Lives: ${this.lives}`,this.x,this.y)}}(e.width-65,20),l=new i,c=(e.width-60-70)/8,u=Array.from({length:8},((s,i)=>Array.from({length:5},((s,e)=>new t(i*(c+10)+30,30*e+30,c,20,["#FF5733","#33FF57","#3357FF","#FFD700","#FF69B4"][e%5]))))),y=new class{constructor(s,t,e,h,d,a){this.ball=s,this.paddle=t,this.bricks=e,this.score=h,this.lives=d,this.canvas=a,this.sounds=new i,this.sounds.startBackgroundMusic(),this.flatBricks=this.bricks.flat(),this.isGameOver=!1}collisionDetection(){let s=!1;this.flatBricks.forEach((t=>{1===t.status&&this.ball.x>t.x&&this.ball.x<t.x+t.width&&this.ball.y>t.y&&this.ball.y<t.y+t.height&&(this.ball.dy=-this.ball.dy,t.status=0,this.score.update(10),s=!0)})),s&&(this.ball.increaseSpeed(this.score.score),this.sounds.play("brickHit"))}checkGameOver(){this.ball.y+this.ball.dy>this.canvas.height-this.ball.radius&&(this.ball.bounceOffPaddle(this.paddle)?this.sounds.play("paddleHit"):(this.lives.loseLife(),this.sounds.play("ballMiss"),0===this.lives.lives?(this.sounds.stopBackgroundMusic(),this.sounds.play("gameOver"),this.isGameOver=!0,alert("GAME OVER")):this.resetBall()))}}(d,a,u,r,n,e,l);document.addEventListener("keydown",(s=>a.handleKeyDown(s))),document.addEventListener("keyup",(s=>a.handleKeyUp(s))),document.addEventListener("mousemove",(s=>a.handleMouseMove(s))),function s(){h.clearRect(0,0,e.width,e.height),o.render(h,e),a.render(h),d.render(h),r.render(h),n.render(h),u.flat().forEach((s=>s.render(h))),(d.x+d.dx>e.width-d.radius||d.x+d.dx<d.radius)&&(d.dx=-d.dx),d.y+d.dy<d.radius&&(d.dy=-d.dy),y.checkGameOver(),d.bounceOffPaddle(a)&&l.play("paddleHit"),d.move(),a.move(),y.collisionDetection(),y.checkWinCondition(),requestAnimationFrame(s)}()})();